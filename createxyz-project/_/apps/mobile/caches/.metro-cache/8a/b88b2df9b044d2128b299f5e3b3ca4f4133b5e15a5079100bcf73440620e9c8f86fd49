{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"@/utils/useAuth","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"HHge/F+kNWTBLu5mZhqDJclSs98=","exportNames":["*"]}},{"name":"@/utils/usePreventBack","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":56,"index":99}}],"key":"xz7DwicZ76B5gUVRLxA1ia0yYsg=","exportNames":["*"]}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":100},"end":{"line":3,"column":59,"index":159}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":160},"end":{"line":4,"column":65,"index":225}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Alert","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"PEUC6jrQVoAGZ2qYkvimljMOyJI=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Button","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Qu6zcNyglhuEA8P+/WtVpFcLWgA=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Linking","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3Rjz9Of4YombbpmYBhNmyoa9U9Y=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/View","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"4kYBDC6LJJXoH7P9rWDi3vkLVB0=","exportNames":["*"]}},{"name":"react-native-css-interop/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"/OtXpbGsN+xD0SELbqY71AxmSP8=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = MainComponent;\n  var _env2 = require(_dependencyMap[1], \"expo/virtual/env\");\n  var _useAuth = require(_dependencyMap[2], \"@/utils/useAuth\");\n  var _usePreventBack = require(_dependencyMap[3], \"@/utils/usePreventBack\");\n  var _expoRouter = require(_dependencyMap[4], \"expo-router\");\n  var _react = require(_dependencyMap[5], \"react\");\n  var _Alert = _interopRequireDefault(require(_dependencyMap[6], \"react-native-web/dist/exports/Alert\"));\n  var _Button = _interopRequireDefault(require(_dependencyMap[7], \"react-native-web/dist/exports/Button\"));\n  var _Linking = _interopRequireDefault(require(_dependencyMap[8], \"react-native-web/dist/exports/Linking\"));\n  var _View = _interopRequireDefault(require(_dependencyMap[9], \"react-native-web/dist/exports/View\"));\n  var _jsxRuntime = require(_dependencyMap[10], \"react-native-css-interop/jsx-runtime\");\n  var _jsxFileName = \"/home/user/apps/mobile/src/app/auth.web.jsx\",\n    _s = $RefreshSig$();\n  function MainComponent() {\n    _s();\n    const {\n      preventBack: rawPreventBack,\n      mode: rawMode = 'signup'\n    } = (0, _expoRouter.useLocalSearchParams)();\n    const preventBack = rawPreventBack ? JSON.parse(rawPreventBack) : false;\n    if (preventBack) {\n      (0, _usePreventBack.usePreventBack)();\n    }\n    const mode = rawMode === 'signin' ? 'signin' : 'signup';\n    const {\n      isAuthenticated,\n      setAuth\n    } = (0, _useAuth.useAuth)();\n    const iframeRef = (0, _react.useRef)(null);\n    (0, _react.useEffect)(() => {\n      if (isAuthenticated) {\n        _expoRouter.router.back();\n      }\n    }, [isAuthenticated]);\n    (0, _react.useEffect)(() => {\n      const handleMessage = event => {\n        // Verify the origin for security\n        if (event.origin !== _env2.env.EXPO_PUBLIC_PROXY_BASE_URL) {\n          return;\n        }\n        if (event.data.type === 'AUTH_SUCCESS') {\n          setAuth({\n            jwt: event.data.jwt,\n            user: event.data.user\n          });\n        } else if (event.data.type === 'AUTH_ERROR') {\n          console.error('Auth error:', event.data.error);\n        }\n      };\n      window.addEventListener('message', handleMessage);\n      return () => {\n        window.removeEventListener('message', handleMessage);\n      };\n    }, [setAuth]);\n    const handleIframeLoad = () => {\n      // Iframe has loaded, ready to receive messages\n      console.log('Auth iframe loaded');\n    };\n    const handleIframeError = () => {\n      console.error('Failed to load auth iframe');\n    };\n    return (0, _jsxRuntime.jsx)(\"iframe\", {\n      ref: iframeRef,\n      title: \"Authentication\",\n      src: `${_env2.env.EXPO_PUBLIC_PROXY_BASE_URL}/account/${mode}?callbackUrl=/api/auth/expo-web-success`,\n      style: {\n        width: '100%',\n        height: '100%',\n        border: 'none'\n      },\n      onLoad: handleIframeLoad,\n      onError: handleIframeError\n    });\n  }\n  _s(MainComponent, \"px/CPBr9H43VEfmFgqUN21v6/CA=\", false, function () {\n    return [_expoRouter.useLocalSearchParams, _usePreventBack.usePreventBack, _useAuth.useAuth];\n  });\n  _c = MainComponent;\n  var _c;\n  $RefreshReg$(_c, \"MainComponent\");\n});","lineCount":86,"map":[[8,2,1,0],[8,6,1,0,"_useAuth"],[8,14,1,0],[8,17,1,0,"require"],[8,24,1,0],[8,25,1,0,"_dependencyMap"],[8,39,1,0],[9,2,2,0],[9,6,2,0,"_usePreventBack"],[9,21,2,0],[9,24,2,0,"require"],[9,31,2,0],[9,32,2,0,"_dependencyMap"],[9,46,2,0],[10,2,3,0],[10,6,3,0,"_expoRouter"],[10,17,3,0],[10,20,3,0,"require"],[10,27,3,0],[10,28,3,0,"_dependencyMap"],[10,42,3,0],[11,2,4,0],[11,6,4,0,"_react"],[11,12,4,0],[11,15,4,0,"require"],[11,22,4,0],[11,23,4,0,"_dependencyMap"],[11,37,4,0],[12,2,4,65],[12,6,4,65,"_Alert"],[12,12,4,65],[12,15,4,65,"_interopRequireDefault"],[12,37,4,65],[12,38,4,65,"require"],[12,45,4,65],[12,46,4,65,"_dependencyMap"],[12,60,4,65],[13,2,4,65],[13,6,4,65,"_Button"],[13,13,4,65],[13,16,4,65,"_interopRequireDefault"],[13,38,4,65],[13,39,4,65,"require"],[13,46,4,65],[13,47,4,65,"_dependencyMap"],[13,61,4,65],[14,2,4,65],[14,6,4,65,"_Linking"],[14,14,4,65],[14,17,4,65,"_interopRequireDefault"],[14,39,4,65],[14,40,4,65,"require"],[14,47,4,65],[14,48,4,65,"_dependencyMap"],[14,62,4,65],[15,2,4,65],[15,6,4,65,"_View"],[15,11,4,65],[15,14,4,65,"_interopRequireDefault"],[15,36,4,65],[15,37,4,65,"require"],[15,44,4,65],[15,45,4,65,"_dependencyMap"],[15,59,4,65],[16,2,4,65],[16,6,4,65,"_jsxRuntime"],[16,17,4,65],[16,20,4,65,"require"],[16,27,4,65],[16,28,4,65,"_dependencyMap"],[16,42,4,65],[17,2,4,65],[17,6,4,65,"_jsxFileName"],[17,18,4,65],[18,4,4,65,"_s"],[18,6,4,65],[18,9,4,65,"$RefreshSig$"],[18,21,4,65],[19,2,7,15],[19,11,7,24,"MainComponent"],[19,24,7,37,"MainComponent"],[19,25,7,37],[19,27,7,40],[20,4,7,40,"_s"],[20,6,7,40],[21,4,8,1],[21,10,8,7],[22,6,8,9,"preventBack"],[22,17,8,20],[22,19,8,22,"rawPreventBack"],[22,33,8,36],[23,6,8,38,"mode"],[23,10,8,42],[23,12,8,44,"rawMode"],[23,19,8,51],[23,22,8,54],[24,4,8,63],[24,5,8,64],[24,8,9,2],[24,12,9,2,"useLocalSearchParams"],[24,44,9,22],[24,46,9,23],[24,47,9,24],[25,4,10,1],[25,10,10,7,"preventBack"],[25,21,10,18],[25,24,10,21,"rawPreventBack"],[25,38,10,35],[25,41,10,38,"JSON"],[25,45,10,42],[25,46,10,43,"parse"],[25,51,10,48],[25,52,10,49,"rawPreventBack"],[25,66,10,63],[25,67,10,64],[25,70,10,67],[25,75,10,72],[26,4,11,1],[26,8,11,5,"preventBack"],[26,19,11,16],[26,21,11,18],[27,6,12,2],[27,10,12,2,"usePreventBack"],[27,40,12,16],[27,42,12,17],[27,43,12,18],[28,4,13,1],[29,4,14,1],[29,10,14,7,"mode"],[29,14,14,11],[29,17,14,14,"rawMode"],[29,24,14,21],[29,29,14,26],[29,37,14,34],[29,40,14,37],[29,48,14,45],[29,51,14,48],[29,59,14,56],[30,4,16,1],[30,10,16,7],[31,6,16,9,"isAuthenticated"],[31,21,16,24],[32,6,16,26,"setAuth"],[33,4,16,34],[33,5,16,35],[33,8,16,38],[33,12,16,38,"useAuth"],[33,28,16,45],[33,30,16,46],[33,31,16,47],[34,4,17,1],[34,10,17,7,"iframeRef"],[34,19,17,16],[34,22,17,19],[34,26,17,19,"useRef"],[34,39,17,25],[34,41,17,26],[34,45,17,30],[34,46,17,31],[35,4,19,1],[35,8,19,1,"useEffect"],[35,24,19,10],[35,26,19,11],[35,32,19,17],[36,6,20,2],[36,10,20,6,"isAuthenticated"],[36,25,20,21],[36,27,20,23],[37,8,21,3,"router"],[37,26,21,9],[37,27,21,10,"back"],[37,31,21,14],[37,32,21,15],[37,33,21,16],[38,6,22,2],[39,4,23,1],[39,5,23,2],[39,7,23,4],[39,8,23,5,"isAuthenticated"],[39,23,23,20],[39,24,23,21],[39,25,23,22],[40,4,25,1],[40,8,25,1,"useEffect"],[40,24,25,10],[40,26,25,11],[40,32,25,17],[41,6,26,2],[41,12,26,8,"handleMessage"],[41,25,26,21],[41,28,26,25,"event"],[41,33,26,30],[41,37,26,35],[42,8,27,3],[43,8,28,3],[43,12,28,7,"event"],[43,17,28,12],[43,18,28,13,"origin"],[43,24,28,19],[43,29,28,19,"_env2"],[43,34,28,19],[43,35,28,19,"env"],[43,38,28,19],[43,39,28,19,"EXPO_PUBLIC_PROXY_BASE_URL"],[43,65,28,62],[43,67,28,64],[44,10,29,4],[45,8,30,3],[46,8,31,3],[46,12,31,7,"event"],[46,17,31,12],[46,18,31,13,"data"],[46,22,31,17],[46,23,31,18,"type"],[46,27,31,22],[46,32,31,27],[46,46,31,41],[46,48,31,43],[47,10,32,4,"setAuth"],[47,17,32,11],[47,18,32,12],[48,12,33,5,"jwt"],[48,15,33,8],[48,17,33,10,"event"],[48,22,33,15],[48,23,33,16,"data"],[48,27,33,20],[48,28,33,21,"jwt"],[48,31,33,24],[49,12,34,5,"user"],[49,16,34,9],[49,18,34,11,"event"],[49,23,34,16],[49,24,34,17,"data"],[49,28,34,21],[49,29,34,22,"user"],[50,10,35,4],[50,11,35,5],[50,12,35,6],[51,8,36,3],[51,9,36,4],[51,15,36,10],[51,19,36,14,"event"],[51,24,36,19],[51,25,36,20,"data"],[51,29,36,24],[51,30,36,25,"type"],[51,34,36,29],[51,39,36,34],[51,51,36,46],[51,53,36,48],[52,10,37,4,"console"],[52,17,37,11],[52,18,37,12,"error"],[52,23,37,17],[52,24,37,18],[52,37,37,31],[52,39,37,33,"event"],[52,44,37,38],[52,45,37,39,"data"],[52,49,37,43],[52,50,37,44,"error"],[52,55,37,49],[52,56,37,50],[53,8,38,3],[54,6,39,2],[54,7,39,3],[55,6,41,2,"window"],[55,12,41,8],[55,13,41,9,"addEventListener"],[55,29,41,25],[55,30,41,26],[55,39,41,35],[55,41,41,37,"handleMessage"],[55,54,41,50],[55,55,41,51],[56,6,43,2],[56,13,43,9],[56,19,43,15],[57,8,44,3,"window"],[57,14,44,9],[57,15,44,10,"removeEventListener"],[57,34,44,29],[57,35,44,30],[57,44,44,39],[57,46,44,41,"handleMessage"],[57,59,44,54],[57,60,44,55],[58,6,45,2],[58,7,45,3],[59,4,46,1],[59,5,46,2],[59,7,46,4],[59,8,46,5,"setAuth"],[59,15,46,12],[59,16,46,13],[59,17,46,14],[60,4,48,1],[60,10,48,7,"handleIframeLoad"],[60,26,48,23],[60,29,48,26,"handleIframeLoad"],[60,30,48,26],[60,35,48,32],[61,6,49,2],[62,6,50,2,"console"],[62,13,50,9],[62,14,50,10,"log"],[62,17,50,13],[62,18,50,14],[62,38,50,34],[62,39,50,35],[63,4,51,1],[63,5,51,2],[64,4,53,1],[64,10,53,7,"handleIframeError"],[64,27,53,24],[64,30,53,27,"handleIframeError"],[64,31,53,27],[64,36,53,33],[65,6,54,2,"console"],[65,13,54,9],[65,14,54,10,"error"],[65,19,54,15],[65,20,54,16],[65,48,54,44],[65,49,54,45],[66,4,55,1],[66,5,55,2],[67,4,57,1],[67,11,58,2],[67,15,58,2,"_jsxRuntime"],[67,26,58,2],[67,27,58,2,"jsx"],[67,30,58,2],[68,6,59,3,"ref"],[68,9,59,6],[68,11,59,8,"iframeRef"],[68,20,59,18],[69,6,60,3,"title"],[69,11,60,8],[69,13,60,9],[69,29,60,25],[70,6,61,3,"src"],[70,9,61,6],[70,11,61,8],[70,14,61,8,"_env2"],[70,19,61,8],[70,20,61,8,"env"],[70,23,61,8],[70,24,61,8,"EXPO_PUBLIC_PROXY_BASE_URL"],[70,50,61,8],[70,62,61,61,"mode"],[70,66,61,65],[70,107,61,107],[71,6,62,3,"style"],[71,11,62,8],[71,13,62,10],[72,8,62,12,"width"],[72,13,62,17],[72,15,62,19],[72,21,62,25],[73,8,62,27,"height"],[73,14,62,33],[73,16,62,35],[73,22,62,41],[74,8,62,43,"border"],[74,14,62,49],[74,16,62,51],[75,6,62,58],[75,7,62,60],[76,6,63,3,"onLoad"],[76,12,63,9],[76,14,63,11,"handleIframeLoad"],[76,30,63,28],[77,6,64,3,"onError"],[77,13,64,10],[77,15,64,12,"handleIframeError"],[78,4,64,30],[78,5,65,3],[78,6,65,4],[79,2,67,0],[80,2,67,1,"_s"],[80,4,67,1],[80,5,7,24,"MainComponent"],[80,18,7,37],[81,4,7,37],[81,12,9,2,"useLocalSearchParams"],[81,44,9,22],[81,46,12,2,"usePreventBack"],[81,76,12,16],[81,78,16,38,"useAuth"],[81,94,16,45],[82,2,16,45],[83,2,16,45,"_c"],[83,4,16,45],[83,7,7,24,"MainComponent"],[83,20,7,37],[84,2,7,37],[84,6,7,37,"_c"],[84,8,7,37],[85,2,7,37,"$RefreshReg$"],[85,14,7,37],[85,15,7,37,"_c"],[85,17,7,37],[86,0,7,37],[86,3]],"functionMap":{"names":["<global>","MainComponent","useEffect$argument_0","handleMessage","<anonymous>","handleIframeLoad","handleIframeError"],"mappings":"AAA;eCM;WCY;EDI;WCE;wBCC;GDa;SEI;GFE;EDC;0BIE;EJG;2BKE;ELE;CDY"}},"type":"js/module"}]}