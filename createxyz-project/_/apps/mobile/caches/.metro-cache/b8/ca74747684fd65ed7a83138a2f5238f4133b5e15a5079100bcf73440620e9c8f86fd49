{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"@/utils/useAuth","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"HHge/F+kNWTBLu5mZhqDJclSs98=","exportNames":["*"]}},{"name":"@/utils/usePreventBack","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":56,"index":99}}],"key":"xz7DwicZ76B5gUVRLxA1ia0yYsg=","exportNames":["*"]}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":100},"end":{"line":3,"column":59,"index":159}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":160},"end":{"line":4,"column":65,"index":225}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":226},"end":{"line":5,"column":60,"index":286}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"]}},{"name":"react-native-css-interop/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"/OtXpbGsN+xD0SELbqY71AxmSP8=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = MainComponent;\n  var _env2 = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _useAuth2 = require(_dependencyMap[1], \"@/utils/useAuth\");\n  var _usePreventBack = require(_dependencyMap[2], \"@/utils/usePreventBack\");\n  var _expoRouter = require(_dependencyMap[3], \"expo-router\");\n  var _react = require(_dependencyMap[4], \"react\");\n  var _reactNative = require(_dependencyMap[5], \"react-native\");\n  var _jsxRuntime = require(_dependencyMap[6], \"react-native-css-interop/jsx-runtime\");\n  var _jsxFileName = \"/home/user/apps/mobile/src/app/auth.web.jsx\",\n    _s = $RefreshSig$();\n  function MainComponent() {\n    _s();\n    var _useLocalSearchParams = (0, _expoRouter.useLocalSearchParams)(),\n      rawPreventBack = _useLocalSearchParams.preventBack,\n      _useLocalSearchParams2 = _useLocalSearchParams.mode,\n      rawMode = _useLocalSearchParams2 === void 0 ? 'signup' : _useLocalSearchParams2;\n    var preventBack = rawPreventBack ? JSON.parse(rawPreventBack) : false;\n    if (preventBack) {\n      (0, _usePreventBack.usePreventBack)();\n    }\n    var mode = rawMode === 'signin' ? 'signin' : 'signup';\n    var _useAuth = (0, _useAuth2.useAuth)(),\n      isAuthenticated = _useAuth.isAuthenticated,\n      setAuth = _useAuth.setAuth;\n    var iframeRef = (0, _react.useRef)(null);\n    (0, _react.useEffect)(() => {\n      if (isAuthenticated) {\n        _expoRouter.router.back();\n      }\n    }, [isAuthenticated]);\n    (0, _react.useEffect)(() => {\n      var handleMessage = event => {\n        // Verify the origin for security\n        if (event.origin !== _env2.env.EXPO_PUBLIC_PROXY_BASE_URL) {\n          return;\n        }\n        if (event.data.type === 'AUTH_SUCCESS') {\n          setAuth({\n            jwt: event.data.jwt,\n            user: event.data.user\n          });\n        } else if (event.data.type === 'AUTH_ERROR') {\n          console.error('Auth error:', event.data.error);\n        }\n      };\n      window.addEventListener('message', handleMessage);\n      return () => {\n        window.removeEventListener('message', handleMessage);\n      };\n    }, [setAuth]);\n    var handleIframeLoad = () => {\n      // Iframe has loaded, ready to receive messages\n      console.log('Auth iframe loaded');\n    };\n    var handleIframeError = () => {\n      console.error('Failed to load auth iframe');\n    };\n    return (0, _jsxRuntime.jsx)(\"iframe\", {\n      ref: iframeRef,\n      title: \"Authentication\",\n      src: `${_env2.env.EXPO_PUBLIC_PROXY_BASE_URL}/account/${mode}?callbackUrl=/api/auth/expo-web-success`,\n      style: {\n        width: '100%',\n        height: '100%',\n        border: 'none'\n      },\n      onLoad: handleIframeLoad,\n      onError: handleIframeError\n    });\n  }\n  _s(MainComponent, \"px/CPBr9H43VEfmFgqUN21v6/CA=\", false, function () {\n    return [_expoRouter.useLocalSearchParams, _usePreventBack.usePreventBack, _useAuth2.useAuth];\n  });\n  _c = MainComponent;\n  var _c;\n  $RefreshReg$(_c, \"MainComponent\");\n});","lineCount":81,"map":[[7,2,1,0],[7,6,1,0,"_useAuth2"],[7,15,1,0],[7,18,1,0,"require"],[7,25,1,0],[7,26,1,0,"_dependencyMap"],[7,40,1,0],[8,2,2,0],[8,6,2,0,"_usePreventBack"],[8,21,2,0],[8,24,2,0,"require"],[8,31,2,0],[8,32,2,0,"_dependencyMap"],[8,46,2,0],[9,2,3,0],[9,6,3,0,"_expoRouter"],[9,17,3,0],[9,20,3,0,"require"],[9,27,3,0],[9,28,3,0,"_dependencyMap"],[9,42,3,0],[10,2,4,0],[10,6,4,0,"_react"],[10,12,4,0],[10,15,4,0,"require"],[10,22,4,0],[10,23,4,0,"_dependencyMap"],[10,37,4,0],[11,2,5,0],[11,6,5,0,"_reactNative"],[11,18,5,0],[11,21,5,0,"require"],[11,28,5,0],[11,29,5,0,"_dependencyMap"],[11,43,5,0],[12,2,5,60],[12,6,5,60,"_jsxRuntime"],[12,17,5,60],[12,20,5,60,"require"],[12,27,5,60],[12,28,5,60,"_dependencyMap"],[12,42,5,60],[13,2,5,60],[13,6,5,60,"_jsxFileName"],[13,18,5,60],[14,4,5,60,"_s"],[14,6,5,60],[14,9,5,60,"$RefreshSig$"],[14,21,5,60],[15,2,7,15],[15,11,7,24,"MainComponent"],[15,24,7,37,"MainComponent"],[15,25,7,37],[15,27,7,40],[16,4,7,40,"_s"],[16,6,7,40],[17,4,8,1],[17,8,8,1,"_useLocalSearchParams"],[17,29,8,1],[17,32,9,2],[17,36,9,2,"useLocalSearchParams"],[17,68,9,22],[17,70,9,23],[17,71,9,24],[18,6,8,22,"rawPreventBack"],[18,20,8,36],[18,23,8,36,"_useLocalSearchParams"],[18,44,8,36],[18,45,8,9,"preventBack"],[18,56,8,20],[19,6,8,20,"_useLocalSearchParams2"],[19,28,8,20],[19,31,8,20,"_useLocalSearchParams"],[19,52,8,20],[19,53,8,38,"mode"],[19,57,8,42],[20,6,8,44,"rawMode"],[20,13,8,51],[20,16,8,51,"_useLocalSearchParams2"],[20,38,8,51],[20,52,8,54],[20,60,8,62],[20,63,8,62,"_useLocalSearchParams2"],[20,85,8,62],[21,4,10,1],[21,8,10,7,"preventBack"],[21,19,10,18],[21,22,10,21,"rawPreventBack"],[21,36,10,35],[21,39,10,38,"JSON"],[21,43,10,42],[21,44,10,43,"parse"],[21,49,10,48],[21,50,10,49,"rawPreventBack"],[21,64,10,63],[21,65,10,64],[21,68,10,67],[21,73,10,72],[22,4,11,1],[22,8,11,5,"preventBack"],[22,19,11,16],[22,21,11,18],[23,6,12,2],[23,10,12,2,"usePreventBack"],[23,40,12,16],[23,42,12,17],[23,43,12,18],[24,4,13,1],[25,4,14,1],[25,8,14,7,"mode"],[25,12,14,11],[25,15,14,14,"rawMode"],[25,22,14,21],[25,27,14,26],[25,35,14,34],[25,38,14,37],[25,46,14,45],[25,49,14,48],[25,57,14,56],[26,4,16,1],[26,8,16,1,"_useAuth"],[26,16,16,1],[26,19,16,38],[26,23,16,38,"useAuth"],[26,40,16,45],[26,42,16,46],[26,43,16,47],[27,6,16,9,"isAuthenticated"],[27,21,16,24],[27,24,16,24,"_useAuth"],[27,32,16,24],[27,33,16,9,"isAuthenticated"],[27,48,16,24],[28,6,16,26,"setAuth"],[28,13,16,33],[28,16,16,33,"_useAuth"],[28,24,16,33],[28,25,16,26,"setAuth"],[28,32,16,33],[29,4,17,1],[29,8,17,7,"iframeRef"],[29,17,17,16],[29,20,17,19],[29,24,17,19,"useRef"],[29,37,17,25],[29,39,17,26],[29,43,17,30],[29,44,17,31],[30,4,19,1],[30,8,19,1,"useEffect"],[30,24,19,10],[30,26,19,11],[30,32,19,17],[31,6,20,2],[31,10,20,6,"isAuthenticated"],[31,25,20,21],[31,27,20,23],[32,8,21,3,"router"],[32,26,21,9],[32,27,21,10,"back"],[32,31,21,14],[32,32,21,15],[32,33,21,16],[33,6,22,2],[34,4,23,1],[34,5,23,2],[34,7,23,4],[34,8,23,5,"isAuthenticated"],[34,23,23,20],[34,24,23,21],[34,25,23,22],[35,4,25,1],[35,8,25,1,"useEffect"],[35,24,25,10],[35,26,25,11],[35,32,25,17],[36,6,26,2],[36,10,26,8,"handleMessage"],[36,23,26,21],[36,26,26,25,"event"],[36,31,26,30],[36,35,26,35],[37,8,27,3],[38,8,28,3],[38,12,28,7,"event"],[38,17,28,12],[38,18,28,13,"origin"],[38,24,28,19],[38,29,28,19,"_env2"],[38,34,28,19],[38,35,28,19,"env"],[38,38,28,19],[38,39,28,19,"EXPO_PUBLIC_PROXY_BASE_URL"],[38,65,28,62],[38,67,28,64],[39,10,29,4],[40,8,30,3],[41,8,31,3],[41,12,31,7,"event"],[41,17,31,12],[41,18,31,13,"data"],[41,22,31,17],[41,23,31,18,"type"],[41,27,31,22],[41,32,31,27],[41,46,31,41],[41,48,31,43],[42,10,32,4,"setAuth"],[42,17,32,11],[42,18,32,12],[43,12,33,5,"jwt"],[43,15,33,8],[43,17,33,10,"event"],[43,22,33,15],[43,23,33,16,"data"],[43,27,33,20],[43,28,33,21,"jwt"],[43,31,33,24],[44,12,34,5,"user"],[44,16,34,9],[44,18,34,11,"event"],[44,23,34,16],[44,24,34,17,"data"],[44,28,34,21],[44,29,34,22,"user"],[45,10,35,4],[45,11,35,5],[45,12,35,6],[46,8,36,3],[46,9,36,4],[46,15,36,10],[46,19,36,14,"event"],[46,24,36,19],[46,25,36,20,"data"],[46,29,36,24],[46,30,36,25,"type"],[46,34,36,29],[46,39,36,34],[46,51,36,46],[46,53,36,48],[47,10,37,4,"console"],[47,17,37,11],[47,18,37,12,"error"],[47,23,37,17],[47,24,37,18],[47,37,37,31],[47,39,37,33,"event"],[47,44,37,38],[47,45,37,39,"data"],[47,49,37,43],[47,50,37,44,"error"],[47,55,37,49],[47,56,37,50],[48,8,38,3],[49,6,39,2],[49,7,39,3],[50,6,41,2,"window"],[50,12,41,8],[50,13,41,9,"addEventListener"],[50,29,41,25],[50,30,41,26],[50,39,41,35],[50,41,41,37,"handleMessage"],[50,54,41,50],[50,55,41,51],[51,6,43,2],[51,13,43,9],[51,19,43,15],[52,8,44,3,"window"],[52,14,44,9],[52,15,44,10,"removeEventListener"],[52,34,44,29],[52,35,44,30],[52,44,44,39],[52,46,44,41,"handleMessage"],[52,59,44,54],[52,60,44,55],[53,6,45,2],[53,7,45,3],[54,4,46,1],[54,5,46,2],[54,7,46,4],[54,8,46,5,"setAuth"],[54,15,46,12],[54,16,46,13],[54,17,46,14],[55,4,48,1],[55,8,48,7,"handleIframeLoad"],[55,24,48,23],[55,27,48,26,"handleIframeLoad"],[55,28,48,26],[55,33,48,32],[56,6,49,2],[57,6,50,2,"console"],[57,13,50,9],[57,14,50,10,"log"],[57,17,50,13],[57,18,50,14],[57,38,50,34],[57,39,50,35],[58,4,51,1],[58,5,51,2],[59,4,53,1],[59,8,53,7,"handleIframeError"],[59,25,53,24],[59,28,53,27,"handleIframeError"],[59,29,53,27],[59,34,53,33],[60,6,54,2,"console"],[60,13,54,9],[60,14,54,10,"error"],[60,19,54,15],[60,20,54,16],[60,48,54,44],[60,49,54,45],[61,4,55,1],[61,5,55,2],[62,4,57,1],[62,11,58,2],[62,15,58,2,"_jsxRuntime"],[62,26,58,2],[62,27,58,2,"jsx"],[62,30,58,2],[63,6,59,3,"ref"],[63,9,59,6],[63,11,59,8,"iframeRef"],[63,20,59,18],[64,6,60,3,"title"],[64,11,60,8],[64,13,60,9],[64,29,60,25],[65,6,61,3,"src"],[65,9,61,6],[65,11,61,8],[65,14,61,8,"_env2"],[65,19,61,8],[65,20,61,8,"env"],[65,23,61,8],[65,24,61,8,"EXPO_PUBLIC_PROXY_BASE_URL"],[65,50,61,8],[65,62,61,61,"mode"],[65,66,61,65],[65,107,61,107],[66,6,62,3,"style"],[66,11,62,8],[66,13,62,10],[67,8,62,12,"width"],[67,13,62,17],[67,15,62,19],[67,21,62,25],[68,8,62,27,"height"],[68,14,62,33],[68,16,62,35],[68,22,62,41],[69,8,62,43,"border"],[69,14,62,49],[69,16,62,51],[70,6,62,58],[70,7,62,60],[71,6,63,3,"onLoad"],[71,12,63,9],[71,14,63,11,"handleIframeLoad"],[71,30,63,28],[72,6,64,3,"onError"],[72,13,64,10],[72,15,64,12,"handleIframeError"],[73,4,64,30],[73,5,65,3],[73,6,65,4],[74,2,67,0],[75,2,67,1,"_s"],[75,4,67,1],[75,5,7,24,"MainComponent"],[75,18,7,37],[76,4,7,37],[76,12,9,2,"useLocalSearchParams"],[76,44,9,22],[76,46,12,2,"usePreventBack"],[76,76,12,16],[76,78,16,38,"useAuth"],[76,95,16,45],[77,2,16,45],[78,2,16,45,"_c"],[78,4,16,45],[78,7,7,24,"MainComponent"],[78,20,7,37],[79,2,7,37],[79,6,7,37,"_c"],[79,8,7,37],[80,2,7,37,"$RefreshReg$"],[80,14,7,37],[80,15,7,37,"_c"],[80,17,7,37],[81,0,7,37],[81,3]],"functionMap":{"names":["<global>","MainComponent","useEffect$argument_0","handleMessage","<anonymous>","handleIframeLoad","handleIframeError"],"mappings":"AAA;eCM;WCY;EDI;WCE;wBCC;GDa;SEI;GFE;EDC;0BIE;EJG;2BKE;ELE;CDY"}},"type":"js/module"}]}