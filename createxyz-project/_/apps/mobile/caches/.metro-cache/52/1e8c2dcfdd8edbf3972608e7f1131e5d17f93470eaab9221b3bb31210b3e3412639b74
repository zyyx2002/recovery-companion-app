{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"]}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"]}},{"name":"@/utils/useAuth","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"HHge/F+kNWTBLu5mZhqDJclSs98=","exportNames":["*"]}},{"name":"@/utils/usePreventBack","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":56,"index":99}}],"key":"xz7DwicZ76B5gUVRLxA1ia0yYsg=","exportNames":["*"]}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":100},"end":{"line":3,"column":59,"index":159}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":160},"end":{"line":4,"column":44,"index":204}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"react-native-webview","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":205},"end":{"line":5,"column":47,"index":252}}],"key":"YJc7i/oIweCWhKjzjfYLEcLeUJA=","exportNames":["*"]}},{"name":"react-native-css-interop/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"/OtXpbGsN+xD0SELbqY71AxmSP8=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = MainComponent;\n  var _asyncToGenerator2 = _interopRequireDefault(require(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\"));\n  var _env2 = require(_dependencyMap[2], \"expo/virtual/env\");\n  var _slicedToArray2 = _interopRequireDefault(require(_dependencyMap[3], \"@babel/runtime/helpers/slicedToArray\"));\n  var _useAuth2 = require(_dependencyMap[4], \"@/utils/useAuth\");\n  var _usePreventBack = require(_dependencyMap[5], \"@/utils/usePreventBack\");\n  var _expoRouter = require(_dependencyMap[6], \"expo-router\");\n  var _react = require(_dependencyMap[7], \"react\");\n  var _reactNativeWebview = require(_dependencyMap[8], \"react-native-webview\");\n  var _jsxRuntime = require(_dependencyMap[9], \"react-native-css-interop/jsx-runtime\");\n  var _jsxFileName = \"/home/user/apps/mobile/src/app/auth.jsx\",\n    _s = $RefreshSig$();\n  var callbackUrl = '/api/auth/token';\n  var callbackQueryString = `callbackUrl=${callbackUrl}`;\n  function MainComponent() {\n    _s();\n    var _useLocalSearchParams = (0, _expoRouter.useLocalSearchParams)(),\n      rawPreventBack = _useLocalSearchParams.preventBack,\n      _useLocalSearchParams2 = _useLocalSearchParams.mode,\n      rawMode = _useLocalSearchParams2 === void 0 ? 'signup' : _useLocalSearchParams2;\n    var preventBack = rawPreventBack ? JSON.parse(rawPreventBack) : false;\n    if (preventBack) {\n      (0, _usePreventBack.usePreventBack)();\n    }\n    var mode = rawMode === 'signin' ? 'signin' : 'signup';\n    var _useState = (0, _react.useState)(`${_env2.env.EXPO_PUBLIC_BASE_URL}/account/${mode}?${callbackQueryString}`),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      currentURI = _useState2[0],\n      setURI = _useState2[1];\n    var _useAuth = (0, _useAuth2.useAuth)(),\n      isAuthenticated = _useAuth.isAuthenticated,\n      setAuth = _useAuth.setAuth;\n    (0, _react.useEffect)(() => {\n      if (isAuthenticated) {\n        _expoRouter.router.back();\n      }\n    }, [isAuthenticated]);\n    return (0, _jsxRuntime.jsx)(_reactNativeWebview.WebView, {\n      sharedCookiesEnabled: true,\n      source: {\n        uri: currentURI\n      },\n      onShouldStartLoadWithRequest: request => {\n        if (request.url === `${_env2.env.EXPO_PUBLIC_BASE_URL}${callbackUrl}`) {\n          fetch(request.url).then(/*#__PURE__*/function () {\n            var _ref = (0, _asyncToGenerator2.default)(function* (response) {\n              response.json().then(data => {\n                setAuth({\n                  jwt: data.jwt,\n                  user: data.user\n                });\n              });\n            });\n            return function (_x) {\n              return _ref.apply(this, arguments);\n            };\n          }());\n          return false;\n        }\n        if (request.url === currentURI) return true;\n\n        // Add query string properly by checking if URL already has parameters\n        var hasParams = request.url.includes('?');\n        var separator = hasParams ? '&' : '?';\n        var newURL = request.url.replaceAll(_env2.env.EXPO_PUBLIC_PROXY_BASE_URL, _env2.env.EXPO_PUBLIC_BASE_URL);\n        if (newURL.endsWith(callbackUrl)) {\n          setURI(newURL);\n          return false;\n        }\n        setURI(`${newURL}${separator}${callbackQueryString}`);\n        return false;\n      },\n      style: {\n        flex: 1\n      }\n    });\n  }\n  _s(MainComponent, \"I4ng36XS/TdyXmJtWc7fwhnrES8=\", false, function () {\n    return [_expoRouter.useLocalSearchParams, _usePreventBack.usePreventBack, _useAuth2.useAuth];\n  });\n  _c = MainComponent;\n  var _c;\n  $RefreshReg$(_c, \"MainComponent\");\n});","lineCount":89,"map":[[10,2,1,0],[10,6,1,0,"_useAuth2"],[10,15,1,0],[10,18,1,0,"require"],[10,25,1,0],[10,26,1,0,"_dependencyMap"],[10,40,1,0],[11,2,2,0],[11,6,2,0,"_usePreventBack"],[11,21,2,0],[11,24,2,0,"require"],[11,31,2,0],[11,32,2,0,"_dependencyMap"],[11,46,2,0],[12,2,3,0],[12,6,3,0,"_expoRouter"],[12,17,3,0],[12,20,3,0,"require"],[12,27,3,0],[12,28,3,0,"_dependencyMap"],[12,42,3,0],[13,2,4,0],[13,6,4,0,"_react"],[13,12,4,0],[13,15,4,0,"require"],[13,22,4,0],[13,23,4,0,"_dependencyMap"],[13,37,4,0],[14,2,5,0],[14,6,5,0,"_reactNativeWebview"],[14,25,5,0],[14,28,5,0,"require"],[14,35,5,0],[14,36,5,0,"_dependencyMap"],[14,50,5,0],[15,2,5,47],[15,6,5,47,"_jsxRuntime"],[15,17,5,47],[15,20,5,47,"require"],[15,27,5,47],[15,28,5,47,"_dependencyMap"],[15,42,5,47],[16,2,5,47],[16,6,5,47,"_jsxFileName"],[16,18,5,47],[17,4,5,47,"_s"],[17,6,5,47],[17,9,5,47,"$RefreshSig$"],[17,21,5,47],[18,2,7,0],[18,6,7,6,"callbackUrl"],[18,17,7,17],[18,20,7,20],[18,37,7,37],[19,2,8,0],[19,6,8,6,"callbackQueryString"],[19,25,8,25],[19,28,8,28],[19,43,8,43,"callbackUrl"],[19,54,8,54],[19,56,8,56],[20,2,10,15],[20,11,10,24,"MainComponent"],[20,24,10,37,"MainComponent"],[20,25,10,37],[20,27,10,40],[21,4,10,40,"_s"],[21,6,10,40],[22,4,11,1],[22,8,11,1,"_useLocalSearchParams"],[22,29,11,1],[22,32,12,2],[22,36,12,2,"useLocalSearchParams"],[22,68,12,22],[22,70,12,23],[22,71,12,24],[23,6,11,22,"rawPreventBack"],[23,20,11,36],[23,23,11,36,"_useLocalSearchParams"],[23,44,11,36],[23,45,11,9,"preventBack"],[23,56,11,20],[24,6,11,20,"_useLocalSearchParams2"],[24,28,11,20],[24,31,11,20,"_useLocalSearchParams"],[24,52,11,20],[24,53,11,38,"mode"],[24,57,11,42],[25,6,11,44,"rawMode"],[25,13,11,51],[25,16,11,51,"_useLocalSearchParams2"],[25,38,11,51],[25,52,11,54],[25,60,11,62],[25,63,11,62,"_useLocalSearchParams2"],[25,85,11,62],[26,4,13,1],[26,8,13,7,"preventBack"],[26,19,13,18],[26,22,13,21,"rawPreventBack"],[26,36,13,35],[26,39,13,38,"JSON"],[26,43,13,42],[26,44,13,43,"parse"],[26,49,13,48],[26,50,13,49,"rawPreventBack"],[26,64,13,63],[26,65,13,64],[26,68,13,67],[26,73,13,72],[27,4,14,1],[27,8,14,5,"preventBack"],[27,19,14,16],[27,21,14,18],[28,6,15,2],[28,10,15,2,"usePreventBack"],[28,40,15,16],[28,42,15,17],[28,43,15,18],[29,4,16,1],[30,4,17,1],[30,8,17,7,"mode"],[30,12,17,11],[30,15,17,14,"rawMode"],[30,22,17,21],[30,27,17,26],[30,35,17,34],[30,38,17,37],[30,46,17,45],[30,49,17,48],[30,57,17,56],[31,4,19,1],[31,8,19,1,"_useState"],[31,17,19,1],[31,20,19,30],[31,24,19,30,"useState"],[31,39,19,38],[31,41,20,2],[31,44,20,2,"_env2"],[31,49,20,2],[31,50,20,2,"env"],[31,53,20,2],[31,54,20,2,"EXPO_PUBLIC_BASE_URL"],[31,74,20,2],[31,86,20,49,"mode"],[31,90,20,53],[31,94,20,57,"callbackQueryString"],[31,113,20,76],[31,115,21,1],[31,116,21,2],[32,6,21,2,"_useState2"],[32,16,21,2],[32,23,21,2,"_slicedToArray2"],[32,38,21,2],[32,39,21,2,"default"],[32,46,21,2],[32,48,21,2,"_useState"],[32,57,21,2],[33,6,19,8,"currentURI"],[33,16,19,18],[33,19,19,18,"_useState2"],[33,29,19,18],[34,6,19,20,"setURI"],[34,12,19,26],[34,15,19,26,"_useState2"],[34,25,19,26],[35,4,22,1],[35,8,22,1,"_useAuth"],[35,16,22,1],[35,19,22,38],[35,23,22,38,"useAuth"],[35,40,22,45],[35,42,22,46],[35,43,22,47],[36,6,22,9,"isAuthenticated"],[36,21,22,24],[36,24,22,24,"_useAuth"],[36,32,22,24],[36,33,22,9,"isAuthenticated"],[36,48,22,24],[37,6,22,26,"setAuth"],[37,13,22,33],[37,16,22,33,"_useAuth"],[37,24,22,33],[37,25,22,26,"setAuth"],[37,32,22,33],[38,4,23,1],[38,8,23,1,"useEffect"],[38,24,23,10],[38,26,23,11],[38,32,23,17],[39,6,24,2],[39,10,24,6,"isAuthenticated"],[39,25,24,21],[39,27,24,23],[40,8,25,3,"router"],[40,26,25,9],[40,27,25,10,"back"],[40,31,25,14],[40,32,25,15],[40,33,25,16],[41,6,26,2],[42,4,27,1],[42,5,27,2],[42,7,27,4],[42,8,27,5,"isAuthenticated"],[42,23,27,20],[42,24,27,21],[42,25,27,22],[43,4,29,1],[43,11,30,2],[43,15,30,2,"_jsxRuntime"],[43,26,30,2],[43,27,30,2,"jsx"],[43,30,30,2],[43,32,30,3,"_reactNativeWebview"],[43,51,30,3],[43,52,30,3,"WebView"],[43,59,30,10],[44,6,31,3,"sharedCookiesEnabled"],[44,26,31,23],[45,6,32,3,"source"],[45,12,32,9],[45,14,32,11],[46,8,33,4,"uri"],[46,11,33,7],[46,13,33,9,"currentURI"],[47,6,34,3],[47,7,34,5],[48,6,35,3,"onShouldStartLoadWithRequest"],[48,34,35,31],[48,36,35,34,"request"],[48,43,35,41],[48,47,35,46],[49,8,36,4],[49,12,37,5,"request"],[49,19,37,12],[49,20,37,13,"url"],[49,23,37,16],[49,28,37,21],[49,31,37,21,"_env2"],[49,36,37,21],[49,37,37,21,"env"],[49,40,37,21],[49,41,37,21,"EXPO_PUBLIC_BASE_URL"],[49,61,37,21],[49,64,37,59,"callbackUrl"],[49,75,37,70],[49,77,37,72],[49,79,38,6],[50,10,39,5,"fetch"],[50,15,39,10],[50,16,39,11,"request"],[50,23,39,18],[50,24,39,19,"url"],[50,27,39,22],[50,28,39,23],[50,29,39,24,"then"],[50,33,39,28],[51,12,39,28],[51,16,39,28,"_ref"],[51,20,39,28],[51,27,39,28,"_asyncToGenerator2"],[51,45,39,28],[51,46,39,28,"default"],[51,53,39,28],[51,55,39,29],[51,66,39,36,"response"],[51,74,39,44],[51,76,39,49],[52,14,40,6,"response"],[52,22,40,14],[52,23,40,15,"json"],[52,27,40,19],[52,28,40,20],[52,29,40,21],[52,30,40,22,"then"],[52,34,40,26],[52,35,40,28,"data"],[52,39,40,32],[52,43,40,37],[53,16,41,7,"setAuth"],[53,23,41,14],[53,24,41,15],[54,18,41,17,"jwt"],[54,21,41,20],[54,23,41,22,"data"],[54,27,41,26],[54,28,41,27,"jwt"],[54,31,41,30],[55,18,41,32,"user"],[55,22,41,36],[55,24,41,38,"data"],[55,28,41,42],[55,29,41,43,"user"],[56,16,41,48],[56,17,41,49],[56,18,41,50],[57,14,42,6],[57,15,42,7],[57,16,42,8],[58,12,43,5],[58,13,43,6],[59,12,43,6],[59,29,43,6,"_x"],[59,31,43,6],[60,14,43,6],[60,21,43,6,"_ref"],[60,25,43,6],[60,26,43,6,"apply"],[60,31,43,6],[60,38,43,6,"arguments"],[60,47,43,6],[61,12,43,6],[62,10,43,6],[62,14,43,7],[63,10,44,5],[63,17,44,12],[63,22,44,17],[64,8,45,4],[65,8,46,4],[65,12,46,8,"request"],[65,19,46,15],[65,20,46,16,"url"],[65,23,46,19],[65,28,46,24,"currentURI"],[65,38,46,34],[65,40,46,36],[65,47,46,43],[65,51,46,47],[67,8,48,4],[68,8,49,4],[68,12,49,10,"hasParams"],[68,21,49,19],[68,24,49,22,"request"],[68,31,49,29],[68,32,49,30,"url"],[68,35,49,33],[68,36,49,34,"includes"],[68,44,49,42],[68,45,49,43],[68,48,49,46],[68,49,49,47],[69,8,50,4],[69,12,50,10,"separator"],[69,21,50,19],[69,24,50,22,"hasParams"],[69,33,50,31],[69,36,50,34],[69,39,50,37],[69,42,50,40],[69,45,50,43],[70,8,51,4],[70,12,51,10,"newURL"],[70,18,51,16],[70,21,51,19,"request"],[70,28,51,26],[70,29,51,27,"url"],[70,32,51,30],[70,33,51,31,"replaceAll"],[70,43,51,41],[70,44,51,41,"_env2"],[70,49,51,41],[70,50,51,41,"env"],[70,53,51,41],[70,54,51,41,"EXPO_PUBLIC_PROXY_BASE_URL"],[70,80,51,41],[70,82,51,41,"_env2"],[70,87,51,41],[70,88,51,41,"env"],[70,91,51,41],[70,92,51,41,"EXPO_PUBLIC_BASE_URL"],[70,112,54,4],[70,113,54,5],[71,8,55,4],[71,12,55,8,"newURL"],[71,18,55,14],[71,19,55,15,"endsWith"],[71,27,55,23],[71,28,55,24,"callbackUrl"],[71,39,55,35],[71,40,55,36],[71,42,55,38],[72,10,56,5,"setURI"],[72,16,56,11],[72,17,56,12,"newURL"],[72,23,56,18],[72,24,56,19],[73,10,57,5],[73,17,57,12],[73,22,57,17],[74,8,58,4],[75,8,59,4,"setURI"],[75,14,59,10],[75,15,59,11],[75,18,59,14,"newURL"],[75,24,59,20],[75,27,59,23,"separator"],[75,36,59,32],[75,39,59,35,"callbackQueryString"],[75,58,59,54],[75,60,59,56],[75,61,59,57],[76,8,60,4],[76,15,60,11],[76,20,60,16],[77,6,61,3],[77,7,61,5],[78,6,62,3,"style"],[78,11,62,8],[78,13,62,10],[79,8,62,12,"flex"],[79,12,62,16],[79,14,62,18],[80,6,62,20],[81,4,62,22],[81,5,63,3],[81,6,63,4],[82,2,65,0],[83,2,65,1,"_s"],[83,4,65,1],[83,5,10,24,"MainComponent"],[83,18,10,37],[84,4,10,37],[84,12,12,2,"useLocalSearchParams"],[84,44,12,22],[84,46,15,2,"usePreventBack"],[84,76,15,16],[84,78,22,38,"useAuth"],[84,95,22,45],[85,2,22,45],[86,2,22,45,"_c"],[86,4,22,45],[86,7,10,24,"MainComponent"],[86,20,10,37],[87,2,10,37],[87,6,10,37,"_c"],[87,8,10,37],[88,2,10,37,"$RefreshReg$"],[88,14,10,37],[88,15,10,37,"_c"],[88,17,10,37],[89,0,10,37],[89,3]],"functionMap":{"names":["<global>","MainComponent","useEffect$argument_0","WebView.props.onShouldStartLoadWithRequest","fetch.then$argument_0","response.json.then$argument_0"],"mappings":"AAA;eCS;WCa;EDI;iCEQ;6BCI;2BCC;ODE;MDC;IFkB;CDI"}},"type":"js/module"}]}